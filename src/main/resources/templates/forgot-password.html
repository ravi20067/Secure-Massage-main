<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Login | SecureChat</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Existing CSS -->
    <link th:href="@{/css/style.css}" rel="stylesheet">

    <!-- PAGE-SCOPED STYLES -->
    <style>
        /* ===============================
   PAGE: FORGOT PASSWORD (PREMIUM)
   =============================== */

.page-forgot {
    background:
        radial-gradient(circle at top, rgba(79,70,229,.15), transparent 45%),
        radial-gradient(circle at bottom, rgba(34,197,94,.08), transparent 40%),
        #020617;
    color: #f8fafc;
    min-height: 100vh;
}

/* ---------- CARD ---------- */
.page-forgot .forgot-card {
    width: 100%;
    max-width: 420px;
    background:
        linear-gradient(180deg, rgba(15,23,42,.9), rgba(2,6,23,.95));
    backdrop-filter: blur(16px);
    border-radius: 20px;
    border: 1px solid rgba(255,255,255,.08);
    box-shadow:
        0 30px 90px rgba(0,0,0,.7),
        0 0 40px rgba(79,70,229,.15);
    animation: forgotFadeUp .7s ease;
}

/* ---------- TEXT ---------- */
.page-forgot h4 {
    color: #f8fafc;
    font-weight: 600;
    letter-spacing: -.3px;
}

.page-forgot p {
    color: #cbd5f5;
}

.page-forgot label {
    font-size: .9rem;
    color: #e5e7eb;
}

/* ---------- INPUTS ---------- */
.page-forgot input {
    background: rgba(2,6,23,.95);
    border: 1px solid rgba(255,255,255,.14);
    color: #f8fafc !important;
    border-radius: 12px;
}

.page-forgot input::placeholder {
    color: rgba(248,250,252,.45);
}

.page-forgot input:focus {
    background: rgba(2,6,23,.95);
    border-color: #6366f1;
    box-shadow:
        0 0 0 .18rem rgba(99,102,241,.35),
        0 0 25px rgba(99,102,241,.25);
}

/* ---------- CAPTCHA ---------- */
.page-forgot .captcha-box {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 14px;
}

.page-forgot .captcha-box img {
    height: 44px;
    border-radius: 10px;
    background: #fff;
    border: 1px solid rgba(255,255,255,.15);
}

.page-forgot .captcha-refresh {
    background: transparent;
    border: none;
    color: #93c5fd;
    font-size: .9rem;
    padding: 0;
}

.page-forgot .captcha-refresh:hover {
    color: #bfdbfe;
    text-decoration: underline;
}

/* ---------- BUTTON ---------- */
.page-forgot .btn-primary {
    background: linear-gradient(135deg, #4f46e5, #2563eb);
    border: none;
    border-radius: 14px;
    box-shadow:
        0 14px 45px rgba(79,70,229,.45),
        inset 0 0 0 1px rgba(255,255,255,.08);
}

.page-forgot .btn-primary:hover {
    transform: translateY(-3px);
    box-shadow:
        0 22px 60px rgba(79,70,229,.65);
}

/* ---------- ALERTS ---------- */
.page-forgot .alert {
    font-size: .9rem;
    border-radius: 12px;
}

/* ---------- RESPONSIVE ---------- */
@media (max-width: 576px) {
    .page-forgot .forgot-card {
        padding: 26px 22px;
    }
}

/* ---------- ANIMATION ---------- */
@keyframes forgotFadeUp {
    from {
        opacity: 0;
        transform: translateY(22px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }

}

    </style>
</head>

<body class="page-forgot">

<!-- HEADER -->
<div th:replace="~{layout/header :: header}"></div>

<div class="container d-flex justify-content-center align-items-center py-5">
    <div class="card p-4 shadow forgot-card">

        <h4 class="text-center mb-3">üîê Reset Password</h4>
        <p class="text-center text-secondary mb-4">
            Enter your registered email to receive OTP
        </p>

        <div th:if="${error}" class="alert alert-danger text-center" th:text="${error}"></div>

        <div th:if="${param.captchaError}" class="alert alert-danger text-center">
            ‚ùå Invalid Captcha
        </div>

        <form th:action="@{/login/forgot-password/send-otp}" method="post">

            <div class="mb-3">
                <label>Email</label>
                <input type="email" name="email" class="form-control" required>
            </div>

            <div class="captcha-box">
                <img id="captchaImg" src="" alt="Captcha">
                <button type="button" class="captcha-refresh" onclick="loadCaptcha()">
                    Refresh
                </button>
            </div>

            <input type="hidden" name="captchaId" id="captchaId">

            <div class="mb-3">
                <input type="text" name="captcha" id="captcha"
                       class="form-control"
                       placeholder="Enter Captcha" required>
            </div>

            <button class="btn btn-primary w-100">
                Send OTP
            </button>
        </form>

        <div th:if="${msg}" class="alert alert-success mt-3 text-center"
             th:text="${msg}"></div>
    </div>
</div>

<!-- FOOTER -->
<div th:replace="~{layout/footer :: footer}"></div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script th:src="@{/js/login-js.js}"></script>

</body>
</html>
